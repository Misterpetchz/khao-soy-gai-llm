# LINE Chatbot with Google Maps API and ChromaDB Integration

This project is a LINE chatbot that uses the Google Maps API to find places and integrate them into a ChromaDB database for efficient querying. The chatbot allows users to query places based on their preferences using natural language.

## Requirements

- Python 3.8+
- Flask
- LINE Messaging API SDK for Python
- Google Maps API key
- Cohere API key
- dotenv for environment variable management
- ChromaDB for local database management
- HTTPX for making HTTP requests

## Setup

1. Clone the repository:
   ```bash
   git clone https://github.com/your-repo/line-chatbot.git
   cd line-chatbot
   ```
2. Install the dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. Create a `.env` file in the root directory and add your secrets:
   ```ini
   LINE_CHANNEL_SECRET=your_line_channel_secret
   LINE_CHANNEL_ACCESS_TOKEN=your_line_channel_access_token
   TYPHOON_API_KEY=your_typhoon_api_key
   GOOGLE_MAPS_API_KEY=your_google_maps_api_key
   COHERE_API_KEY=your_cohere_api_key
   ```
4. Run the application:
   ```bash
   python app.py
   ```

## Usage

- Send a text message to the LINE chatbot and receive responses generated by the Typhoon API.
- Search Places: Use the command-line interface to search for places:
  ```bash
  python cli.py fetch "Location"
  ```
- Query Places: Query the place collection using natural language:
  ```bash
  python cli.py query "food" -n 3
  ```

## Example Commands

- Fetch and Store Places (Fetch and store place data for a specified location in the database.)
   ```bash
   python cli.py fetch "Chiang Mai"
   ```

- Query Places (Query the place collection to get recommendations for food places.)
   ```bash
   python cli.py query "food" -n 3
   ```

## How it works
- Instead of making costly Google Maps API calls at runtime, I instead embed all locations into a local ChromaDB 
- Some of the metadata that is tagged along with each location includes:
   - Name
   - Address
   - Editorial Summary
   - Rating
   - Type of establishment
   - Total number of ratings
   - Price level
   - Opening hours
   - Reviews(usually top 3 relevant)
   - Dine in
   - Delivery
   - Takeout
- User queries are embedded then matched with relevant restaurant locations, which are then sent back to ChatGPT
- At a high level I use a technique similar to RAG (Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks)

## License

This project is licensed under the Apache 2.0 License.
